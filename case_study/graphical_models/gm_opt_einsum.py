# -*- coding: UTF-8 -*-
import opt_einsum as oe

import numpy as np

from timeit import default_timer as timer

# parameter tensors for the graphical model
R0 = np.array([[1., 1., 1., 1., 1.,
                1., 1.],
               [1., 0.97368281, 0.97375213, 1.03284678, 1.02397138,
                0.68609983, 1.03597924]])
R1 = np.array([[1., 1., 1.],
               [1., 0.78802665, 1.08688029]])
R2 = np.array([[1., 1., 1.],
               [1., 0.81363116, 1.23759219]])
R3 = np.array([[1., 1., 1.],
               [1., 0.76357366, 4.25101471],
               [1., 0.50069634, 5.75481335],
               [1., 0.39069092, 0.84826476],
               [1., 0.3516219, 0.19037327],
               [1., 0.74738604, 0.53172212]])
R4 = np.array([[1., 1., 1., 1., 1.,
                1., 1., 1., 1., 1.,
                1.],
               [1., 0.90096361, 1.00217324, 1.04498547, 0.99807891,
                0.9638449, 1.01212239, 0.98954521, 1.04617917, 0.92777067,
                0.97809396],
               [1., 0.89244962, 0.91122728, 0.84434068, 1.32134474,
                1.0973649, 1.22826973, 0.99096445, 0.9190401, 0.90978988,
                0.89237929],
               [1., 0.95397087, 0.96768305, 1.072956, 1.10426258,
                1.40862225, 1.34363175, 1.06479519, 1.06701566, 0.86046213,
                0.90087764],
               [1., 1.03183004, 0.88422421, 1.19192617, 1.02634858,
                1.11954611, 1.28152727, 0.88690264, 0.93831759, 1.01833195,
                0.95704304],
               [1., 0.97468546, 1.03305643, 0.99386427, 0.97153127,
                0.91747409, 0.89694233, 0.96080514, 1.06932331, 0.98007072,
                0.98007962]])
R5 = np.array([[1., 1., 1., 1., 1.,
                1., 1.],
               [1., 0.87783841, 0.93255748, 1.07634653, 1.00256815,
                0.88366386, 1.00881681],
               [1., 1.01556933, 0.87282912, 0.82608811, 0.93472477,
                1.30758151, 0.93466082],
               [1., 1.07990577, 0.8896655, 1.13239172, 1.12998568,
                2.3246545, 1.34124275],
               [1., 0.89658387, 1.01973214, 1.12449047, 0.87773105,
                2.05564423, 1.31598047],
               [1., 0.96621791, 0.98197815, 0.92527385, 1.05486561,
                0.86559029, 0.88983897]])
R6 = np.array([[1., 1., 1.],
               [1., 1.00002069, 0.99608761],
               [1., 1.00359574, 1.00338067],
               [1., 1.01683869, 1.01949297],
               [1., 1.02172865, 1.00353004],
               [1., 0.99434369, 0.99453959]])
R7 = np.array([[1., 1., 1., 1., 1.,
                1.],
               [1., 1.07598953, 1.10470733, 0.91206621, 0.96480657,
                0.81236231],
               [1., 0.7358991, 1.37996308, 1.23329551, 1.1286002,
                0.9946841],
               [1., 1.12713167, 2.08510371, 1.68678161, 1.00379897,
                1.18351217],
               [1., 0.99982123, 1.96718975, 1.69184762, 0.8935594,
                1.01330485],
               [1., 0.98369011, 0.83484178, 0.90195293, 0.99623218,
                0.96318158]])
R8 = np.array([[1., 1., 1.],
               [1., 0.87832265, 0.96099037],
               [1., 1.0340967, 1.04689603]])
R9 = np.array([[1., 1., 1.],
               [1., 0.83364221, 0.87977821],
               [1., 1.28071622, 0.87663267]])
R10 = np.array([[1., 1., 1., 1., 1.,
                 1., 1.],
                [1., 0.97717213, 0.99037658, 0.9477024, 1.03050453,
                 0.88790037, 0.90623062],
                [1., 0.98349614, 0.99264039, 0.9601124, 0.97551331,
                 0.93332546, 0.92831762],
                [1., 1.01812355, 0.97301374, 0.96731025, 1.00347209,
                 1.2361484, 0.85318083],
                [1., 0.92635406, 1.02085892, 0.92442449, 0.91028399,
                 1.22088714, 1.45077622],
                [1., 0.97774472, 0.95076499, 1.0139125, 0.9568472,
                 1.32271259, 1.18050136],
                [1., 0.9560913, 0.94091623, 1.21529078, 1.11887676,
                 1.16952416, 1.23335565],
                [1., 1.07634323, 0.97447004, 0.96237753, 1.13202211,
                 0.96555089, 0.85546334],
                [1., 1.01553701, 0.9753823, 1.02588595, 0.94024452,
                 0.94032376, 1.12419129],
                [1., 0.98384935, 0.9932023, 1.02141077, 0.976733,
                 0.79095542, 0.92783068],
                [1., 0.98649838, 0.99523387, 0.96422548, 0.97861391,
                 0.8395077, 0.9340641]])
R11 = np.array([[1., 1., 1.],
                [1., 1.01818689, 0.91819293],
                [1., 0.96220533, 0.92697491],
                [1., 1.07163626, 0.93779481],
                [1., 1.20895464, 1.01354755],
                [1., 1.15211351, 1.09542304],
                [1., 1.03437708, 1.28616463],
                [1., 0.9608575, 1.11502984],
                [1., 0.99197964, 1.03184545],
                [1., 0.91955305, 0.94896752],
                [1., 0.93654613, 0.916825]])
R12 = np.array([[1., 1., 1., 1., 1.,
                 1.],
                [1., 0.90149228, 0.90482256, 0.96781203, 0.89736684,
                 0.94279419],
                [1., 1.39330124, 0.77412321, 0.72639915, 1.06361398,
                 0.86211947],
                [1., 1.03568903, 1.39065195, 0.97807567, 1.04294644,
                 0.83682997],
                [1., 1.04918106, 1.36869457, 1.45344905, 0.95846279,
                 0.94728368],
                [1., 0.87899606, 1.4512489, 1.22552973, 1.3481013,
                 0.99410331],
                [1., 1.01119659, 1.2240905, 1.4123756, 1.07250828,
                 1.42248253],
                [1., 0.85398777, 1.18498086, 0.99597049, 0.84401023,
                 1.12068579],
                [1., 0.84381734, 1.15728684, 1.17155787, 0.84453172,
                 1.10754671],
                [1., 1.01965515, 0.83200286, 0.78018479, 0.91913042,
                 0.98471429],
                [1., 1.00888517, 0.81501635, 0.76899789, 1.00113377,
                 0.97683578]])
R13 = np.array([[1., 1., 1.],
                [1., 0.69337719, 1.17792933],
                [1., 0.6594924, 0.79115642],
                [1., 0.80765483, 1.99091931],
                [1., 0.64173989, 1.0739366],
                [1., 17.3475224, 0.89874726],
                [1., 1.67137359, 1.83367571]])
R14 = np.array([[1., 1., 1.],
                [1., 0.99172243, 1.00658616],
                [1., 0.99341024, 0.99753174],
                [1., 1.00135756, 1.00984377],
                [1., 0.99974877, 1.0026057],
                [1., 1.03199202, 0.97677398],
                [1., 1.02379148, 1.00235683]])
R15 = np.array([[1., 1., 1., 1., 1.,
                 1.],
                [1., 0.97119258, 1.01785864, 0.97837564, 0.9599787,
                 0.98841568],
                [1., 0.98416156, 0.97421256, 0.93637938, 0.97896585,
                 0.97220172],
                [1., 0.97625161, 1.06905255, 0.96440703, 1.05101793,
                 0.97194855],
                [1., 0.9578688, 0.99800746, 1.0865077, 0.99160994,
                 0.9699087],
                [1., 1.05510581, 1.46180041, 1.39335398, 1.03462062,
                 1.07342788],
                [1., 0.97336756, 1.30718401, 1.08467467, 0.87431697,
                 1.02180237]])
R16 = np.array([[1., 1.],
                [1., 0.88136675],
                [1., 0.95922082],
                [1., 1.02875099],
                [1., 1.09119069],
                [1., 0.53959207],
                [1., 1.08873073]])
R17 = np.array([[1., 1., 1.],
                [1., 1.16202404, 0.9304096],
                [1., 1.12712514, 1.16977112]])
R18 = np.array([[1., 1., 1., 1., 1.,
                 1.],
                [1., 0.9936045, 1.41238735, 1.24249126, 0.9857728,
                 0.98317959],
                [1., 0.97015249, 1.13436426, 1.08735126, 0.99667122,
                 1.05528651]])
R19 = np.array([[1., 1.],
                [1., 0.63602335],
                [1., 1.08383496]])
R20 = np.array([[1., 1., 1., 1., 1.,
                 1.],
                [1., 0.96083247, 0.70480528, 1.49130758, 0.82550983,
                 1.29987799]])

# Tensors with one-hot encoded patient data
E0 = np.array([[1., 0., 0., 0., 0., 0.],
               [0., 0., 1., 0., 0., 0.],
               [0., 0., 1., 0., 0., 0.],
               [0., 0., 0., 1., 0., 0.],
               [0., 0., 0., 1., 0., 0.],
               [0., 0., 1., 0., 0., 0.],
               [0., 0., 0., 1., 0., 0.],
               [0., 0., 0., 1., 0., 0.],
               [0., 0., 0., 0., 1., 0.],
               [0., 0., 0., 0., 1., 0.],
               [0., 0., 1., 0., 0., 0.],
               [0., 0., 0., 0., 1., 0.],
               [0., 0., 0., 1., 0., 0.],
               [0., 0., 1., 0., 0., 0.],
               [0., 1., 0., 0., 0., 0.],
               [0., 0., 0., 1., 0., 0.],
               [0., 0., 0., 1., 0., 0.],
               [0., 0., 0., 1., 0., 0.],
               [0., 0., 0., 1., 0., 0.],
               [0., 0., 0., 0., 1., 0.],
               [0., 0., 1., 0., 0., 0.],
               [0., 0., 1., 0., 0., 0.],
               [0., 0., 0., 0., 1., 0.],
               [0., 0., 1., 0., 0., 0.],
               [0., 0., 1., 0., 0., 0.],
               [0., 0., 0., 0., 1., 0.],
               [0., 0., 1., 0., 0., 0.],
               [0., 0., 0., 1., 0., 0.],
               [0., 0., 1., 0., 0., 0.],
               [0., 0., 1., 0., 0., 0.],
               [0., 1., 0., 0., 0., 0.],
               [0., 1., 0., 0., 0., 0.],
               [0., 0., 1., 0., 0., 0.],
               [0., 0., 1., 0., 0., 0.],
               [0., 0., 1., 0., 0., 0.],
               [0., 0., 1., 0., 0., 0.],
               [0., 0., 0., 1., 0., 0.],
               [0., 0., 0., 1., 0., 0.],
               [0., 1., 0., 0., 0., 0.],
               [0., 0., 0., 0., 1., 0.],
               [0., 1., 0., 0., 0., 0.],
               [0., 1., 0., 0., 0., 0.],
               [0., 0., 1., 0., 0., 0.],
               [0., 0., 1., 0., 0., 0.],
               [0., 1., 0., 0., 0., 0.],
               [0., 0., 0., 0., 1., 0.],
               [0., 0., 1., 0., 0., 0.],
               [0., 0., 0., 0., 1., 0.],
               [0., 0., 1., 0., 0., 0.],
               [0., 1., 0., 0., 0., 0.],
               [0., 0., 1., 0., 0., 0.],
               [0., 0., 0., 1., 0., 0.],
               [0., 0., 0., 1., 0., 0.],
               [0., 0., 0., 1., 0., 0.],
               [0., 0., 0., 0., 1., 0.],
               [0., 0., 0., 1., 0., 0.],
               [0., 0., 1., 0., 0., 0.],
               [0., 0., 0., 1., 0., 0.],
               [0., 0., 0., 0., 1., 0.],
               [0., 1., 0., 0., 0., 0.],
               [0., 0., 0., 0., 1., 0.],
               [0., 1., 0., 0., 0., 0.],
               [0., 0., 0., 1., 0., 0.],
               [0., 0., 0., 0., 1., 0.],
               [0., 0., 0., 1., 0., 0.],
               [0., 0., 1., 0., 0., 0.],
               [0., 0., 0., 1., 0., 0.],
               [0., 0., 0., 1., 0., 0.],
               [0., 0., 0., 1., 0., 0.],
               [0., 1., 0., 0., 0., 0.],
               [0., 0., 1., 0., 0., 0.],
               [0., 1., 0., 0., 0., 0.],
               [0., 0., 1., 0., 0., 0.],
               [0., 0., 1., 0., 0., 0.],
               [0., 1., 0., 0., 0., 0.],
               [0., 1., 0., 0., 0., 0.],
               [0., 1., 0., 0., 0., 0.],
               [0., 0., 1., 0., 0., 0.],
               [0., 0., 0., 1., 0., 0.],
               [0., 0., 1., 0., 0., 0.],
               [0., 1., 0., 0., 0., 0.],
               [0., 0., 0., 0., 1., 0.],
               [0., 0., 1., 0., 0., 0.],
               [0., 0., 0., 0., 0., 1.],
               [0., 0., 1., 0., 0., 0.],
               [0., 0., 0., 1., 0., 0.],
               [0., 0., 1., 0., 0., 0.],
               [0., 0., 0., 0., 1., 0.],
               [0., 0., 0., 0., 1., 0.],
               [0., 1., 0., 0., 0., 0.],
               [0., 0., 0., 1., 0., 0.],
               [0., 0., 1., 0., 0., 0.],
               [0., 0., 0., 1., 0., 0.],
               [0., 0., 0., 0., 1., 0.],
               [0., 0., 0., 1., 0., 0.],
               [0., 0., 0., 1., 0., 0.],
               [0., 0., 0., 1., 0., 0.],
               [0., 1., 0., 0., 0., 0.],
               [0., 0., 1., 0., 0., 0.],
               [0., 1., 0., 0., 0., 0.]])
E1 = np.array([[0., 0., 1.],
               [0., 0., 1.],
               [0., 0., 1.],
               [1., 0., 0.],
               [1., 0., 0.],
               [0., 0., 1.],
               [1., 0., 0.],
               [0., 0., 1.],
               [1., 0., 0.],
               [1., 0., 0.],
               [0., 0., 1.],
               [1., 0., 0.],
               [1., 0., 0.],
               [0., 0., 1.],
               [0., 0., 1.],
               [1., 0., 0.],
               [1., 0., 0.],
               [1., 0., 0.],
               [1., 0., 0.],
               [1., 0., 0.],
               [0., 0., 1.],
               [0., 0., 1.],
               [1., 0., 0.],
               [0., 0., 1.],
               [0., 0., 1.],
               [1., 0., 0.],
               [0., 0., 1.],
               [0., 0., 1.],
               [0., 0., 1.],
               [0., 0., 1.],
               [0., 1., 0.],
               [0., 0., 1.],
               [0., 0., 1.],
               [0., 0., 1.],
               [0., 0., 1.],
               [0., 0., 1.],
               [1., 0., 0.],
               [1., 0., 0.],
               [0., 0., 1.],
               [1., 0., 0.],
               [0., 0., 1.],
               [0., 0., 1.],
               [0., 0., 1.],
               [0., 0., 1.],
               [0., 0., 1.],
               [1., 0., 0.],
               [0., 0., 1.],
               [1., 0., 0.],
               [0., 0., 1.],
               [0., 0., 1.],
               [0., 0., 1.],
               [0., 0., 1.],
               [0., 0., 1.],
               [0., 0., 1.],
               [1., 0., 0.],
               [1., 0., 0.],
               [0., 0., 1.],
               [1., 0., 0.],
               [1., 0., 0.],
               [0., 0., 1.],
               [1., 0., 0.],
               [0., 0., 1.],
               [0., 0., 1.],
               [1., 0., 0.],
               [0., 1., 0.],
               [0., 0., 1.],
               [1., 0., 0.],
               [1., 0., 0.],
               [0., 0., 1.],
               [0., 0., 1.],
               [0., 0., 1.],
               [0., 0., 1.],
               [0., 0., 1.],
               [0., 0., 1.],
               [0., 0., 1.],
               [0., 0., 1.],
               [0., 0., 1.],
               [0., 0., 1.],
               [1., 0., 0.],
               [1., 0., 0.],
               [0., 0., 1.],
               [1., 0., 0.],
               [0., 0., 1.],
               [1., 0., 0.],
               [0., 0., 1.],
               [1., 0., 0.],
               [0., 0., 1.],
               [1., 0., 0.],
               [1., 0., 0.],
               [0., 0., 1.],
               [0., 0., 1.],
               [0., 0., 1.],
               [1., 0., 0.],
               [1., 0., 0.],
               [0., 0., 1.],
               [0., 0., 1.],
               [1., 0., 0.],
               [0., 0., 1.],
               [0., 0., 1.],
               [0., 0., 1.]])
E2 = np.array(
    [[0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
     [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0],
     [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0],
     [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0],
     [0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
     [0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
     [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0],
     [0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
     [0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0],
     [1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0],
     [0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0],
     [1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
     [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0],
     [0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0],
     [1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0],
     [0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0],
     [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0],
     [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0],
     [0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0],
     [0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0],
     [0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0],
     [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
     [0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0],
     [0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0],
     [0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0],
     [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0], [0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
     [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0], [1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
     [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0],
     [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0],
     [0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
     [0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0], [1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
     [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
     [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0],
     [0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0],
     [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0],
     [0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0],
     [0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0],
     [0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
     [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0],
     [0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
     [0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0],
     [0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0],
     [0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0],
     [0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0],
     [0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0], [1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
     [0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0], [1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
     [0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
     [0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
     [0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0], [1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
     [0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0]])
E3 = np.array([[0., 0., 0., 0., 0., 1., 0.],
               [0., 0., 0., 0., 0., 1., 0.],
               [0., 0., 0., 0., 0., 1., 0.],
               [0., 0., 0., 0., 0., 1., 0.],
               [0., 0., 0., 1., 0., 0., 0.],
               [0., 0., 0., 0., 0., 1., 0.],
               [0., 0., 0., 1., 0., 0., 0.],
               [0., 0., 0., 0., 0., 0., 1.],
               [0., 0., 0., 0., 0., 1., 0.],
               [0., 0., 0., 0., 0., 0., 1.],
               [0., 0., 0., 0., 0., 1., 0.],
               [0., 0., 0., 0., 0., 1., 0.],
               [0., 0., 0., 0., 0., 1., 0.],
               [0., 0., 0., 0., 0., 1., 0.],
               [0., 0., 0., 0., 0., 1., 0.],
               [0., 0., 0., 0., 0., 1., 0.],
               [0., 0., 0., 0., 0., 1., 0.],
               [0., 0., 0., 0., 0., 1., 0.],
               [0., 0., 0., 0., 0., 1., 0.],
               [0., 0., 0., 0., 0., 0., 1.],
               [0., 0., 0., 0., 0., 1., 0.],
               [0., 0., 0., 0., 1., 0., 0.],
               [0., 0., 0., 0., 0., 1., 0.],
               [0., 0., 0., 0., 0., 1., 0.],
               [0., 0., 0., 0., 0., 1., 0.],
               [0., 0., 1., 0., 0., 0., 0.],
               [0., 1., 0., 0., 0., 0., 0.],
               [0., 0., 0., 0., 0., 1., 0.],
               [0., 0., 0., 0., 0., 1., 0.],
               [0., 0., 0., 0., 0., 1., 0.],
               [0., 0., 0., 0., 0., 1., 0.],
               [0., 0., 0., 0., 0., 0., 1.],
               [0., 0., 0., 0., 0., 0., 1.],
               [0., 0., 0., 0., 0., 1., 0.],
               [0., 0., 0., 0., 0., 1., 0.],
               [0., 0., 0., 1., 0., 0., 0.],
               [0., 0., 0., 0., 0., 1., 0.],
               [0., 0., 0., 0., 0., 1., 0.],
               [0., 0., 0., 1., 0., 0., 0.],
               [0., 0., 0., 0., 0., 1., 0.],
               [0., 0., 0., 0., 0., 1., 0.],
               [0., 0., 0., 1., 0., 0., 0.],
               [0., 0., 0., 0., 0., 1., 0.],
               [0., 0., 0., 0., 0., 1., 0.],
               [0., 0., 0., 0., 0., 0., 1.],
               [0., 0., 0., 0., 0., 1., 0.],
               [0., 0., 0., 0., 0., 1., 0.],
               [0., 0., 0., 0., 0., 1., 0.],
               [1., 0., 0., 0., 0., 0., 0.],
               [0., 0., 0., 0., 0., 1., 0.],
               [0., 0., 0., 0., 0., 1., 0.],
               [0., 1., 0., 0., 0., 0., 0.],
               [0., 0., 0., 0., 0., 1., 0.],
               [0., 0., 0., 0., 0., 1., 0.],
               [0., 0., 0., 0., 0., 1., 0.],
               [0., 0., 0., 0., 0., 0., 1.],
               [0., 0., 0., 0., 0., 1., 0.],
               [0., 0., 0., 0., 0., 0., 1.],
               [0., 0., 0., 0., 0., 0., 1.],
               [0., 0., 0., 1., 0., 0., 0.],
               [0., 0., 0., 0., 0., 1., 0.],
               [0., 0., 0., 0., 0., 1., 0.],
               [0., 0., 0., 0., 0., 1., 0.],
               [0., 0., 0., 0., 0., 1., 0.],
               [0., 0., 0., 0., 0., 1., 0.],
               [0., 0., 0., 1., 0., 0., 0.],
               [0., 0., 0., 0., 0., 1., 0.],
               [0., 0., 0., 0., 0., 0., 1.],
               [0., 0., 0., 0., 0., 1., 0.],
               [0., 0., 0., 0., 0., 1., 0.],
               [0., 0., 0., 0., 0., 1., 0.],
               [0., 0., 0., 0., 0., 0., 1.],
               [0., 0., 0., 0., 0., 1., 0.],
               [0., 0., 0., 0., 0., 1., 0.],
               [0., 0., 0., 0., 0., 1., 0.],
               [0., 0., 0., 0., 0., 1., 0.],
               [0., 0., 0., 1., 0., 0., 0.],
               [0., 0., 0., 0., 0., 1., 0.],
               [0., 0., 0., 0., 0., 1., 0.],
               [0., 0., 0., 0., 0., 1., 0.],
               [0., 0., 0., 0., 0., 1., 0.],
               [0., 0., 0., 1., 0., 0., 0.],
               [0., 0., 0., 0., 0., 1., 0.],
               [0., 0., 0., 0., 0., 1., 0.],
               [0., 0., 0., 0., 1., 0., 0.],
               [0., 0., 0., 0., 0., 1., 0.],
               [0., 1., 0., 0., 0., 0., 0.],
               [0., 0., 0., 0., 0., 1., 0.],
               [0., 0., 0., 0., 0., 1., 0.],
               [0., 0., 0., 0., 0., 1., 0.],
               [0., 0., 0., 0., 0., 1., 0.],
               [0., 0., 0., 0., 0., 0., 1.],
               [0., 0., 0., 0., 1., 0., 0.],
               [0., 0., 0., 0., 0., 1., 0.],
               [0., 0., 0., 0., 0., 1., 0.],
               [0., 0., 0., 0., 0., 1., 0.],
               [0., 0., 0., 0., 0., 1., 0.],
               [0., 0., 0., 0., 0., 1., 0.],
               [0., 0., 0., 0., 0., 1., 0.],
               [0., 0., 0., 0., 0., 0., 1.]])
E4 = np.array([[0., 1., 0.],
               [0., 1., 0.],
               [0., 0., 1.],
               [0., 1., 0.],
               [0., 0., 1.],
               [0., 0., 1.],
               [0., 0., 1.],
               [0., 0., 1.],
               [0., 1., 0.],
               [0., 0., 1.],
               [0., 1., 0.],
               [0., 1., 0.],
               [0., 1., 0.],
               [0., 1., 0.],
               [0., 1., 0.],
               [0., 1., 0.],
               [0., 1., 0.],
               [0., 1., 0.],
               [0., 1., 0.],
               [0., 1., 0.],
               [0., 1., 0.],
               [0., 0., 1.],
               [0., 1., 0.],
               [0., 1., 0.],
               [0., 1., 0.],
               [0., 0., 1.],
               [0., 0., 1.],
               [0., 1., 0.],
               [0., 1., 0.],
               [0., 1., 0.],
               [0., 1., 0.],
               [0., 1., 0.],
               [0., 0., 1.],
               [0., 1., 0.],
               [0., 1., 0.],
               [0., 0., 1.],
               [0., 1., 0.],
               [0., 1., 0.],
               [0., 0., 1.],
               [0., 1., 0.],
               [0., 1., 0.],
               [0., 0., 1.],
               [0., 1., 0.],
               [0., 1., 0.],
               [0., 0., 1.],
               [0., 1., 0.],
               [0., 1., 0.],
               [0., 1., 0.],
               [0., 0., 1.],
               [0., 1., 0.],
               [0., 1., 0.],
               [0., 0., 1.],
               [0., 1., 0.],
               [0., 1., 0.],
               [0., 0., 1.],
               [0., 0., 1.],
               [0., 1., 0.],
               [0., 1., 0.],
               [0., 1., 0.],
               [0., 0., 1.],
               [0., 1., 0.],
               [0., 1., 0.],
               [0., 1., 0.],
               [0., 1., 0.],
               [1., 0., 0.],
               [0., 1., 0.],
               [0., 1., 0.],
               [0., 0., 1.],
               [0., 1., 0.],
               [0., 1., 0.],
               [0., 1., 0.],
               [0., 0., 1.],
               [0., 1., 0.],
               [0., 1., 0.],
               [0., 1., 0.],
               [0., 1., 0.],
               [0., 0., 1.],
               [0., 0., 1.],
               [0., 1., 0.],
               [0., 1., 0.],
               [0., 1., 0.],
               [0., 0., 1.],
               [1., 0., 0.],
               [0., 1., 0.],
               [0., 0., 1.],
               [0., 1., 0.],
               [0., 0., 1.],
               [0., 1., 0.],
               [0., 1., 0.],
               [0., 1., 0.],
               [0., 1., 0.],
               [0., 1., 0.],
               [0., 0., 1.],
               [0., 1., 0.],
               [0., 1., 0.],
               [0., 1., 0.],
               [0., 1., 0.],
               [0., 1., 0.],
               [0., 1., 0.],
               [0., 1., 0.]])
E5 = np.array([[0., 1., 0.],
               [1., 0., 0.],
               [0., 0., 1.],
               [0., 1., 0.],
               [0., 0., 1.],
               [0., 0., 1.],
               [0., 1., 0.],
               [0., 1., 0.],
               [0., 1., 0.],
               [0., 1., 0.],
               [0., 1., 0.],
               [0., 1., 0.],
               [0., 0., 1.],
               [0., 0., 1.],
               [0., 1., 0.],
               [0., 1., 0.],
               [0., 1., 0.],
               [1., 0., 0.],
               [1., 0., 0.],
               [0., 1., 0.],
               [0., 1., 0.],
               [0., 1., 0.],
               [0., 0., 1.],
               [0., 1., 0.],
               [1., 0., 0.],
               [0., 0., 1.],
               [0., 0., 1.],
               [1., 0., 0.],
               [1., 0., 0.],
               [1., 0., 0.],
               [0., 0., 1.],
               [0., 1., 0.],
               [0., 1., 0.],
               [1., 0., 0.],
               [0., 1., 0.],
               [0., 0., 1.],
               [1., 0., 0.],
               [1., 0., 0.],
               [0., 1., 0.],
               [1., 0., 0.],
               [1., 0., 0.],
               [0., 1., 0.],
               [0., 0., 1.],
               [0., 1., 0.],
               [0., 1., 0.],
               [0., 0., 1.],
               [1., 0., 0.],
               [0., 1., 0.],
               [0., 0., 1.],
               [0., 1., 0.],
               [0., 1., 0.],
               [0., 0., 1.],
               [1., 0., 0.],
               [0., 0., 1.],
               [0., 1., 0.],
               [0., 0., 1.],
               [0., 1., 0.],
               [0., 0., 1.],
               [0., 1., 0.],
               [0., 0., 1.],
               [1., 0., 0.],
               [0., 0., 1.],
               [0., 1., 0.],
               [0., 1., 0.],
               [1., 0., 0.],
               [0., 1., 0.],
               [1., 0., 0.],
               [0., 1., 0.],
               [0., 1., 0.],
               [0., 1., 0.],
               [0., 1., 0.],
               [0., 1., 0.],
               [1., 0., 0.],
               [1., 0., 0.],
               [1., 0., 0.],
               [0., 0., 1.],
               [0., 0., 1.],
               [0., 0., 1.],
               [1., 0., 0.],
               [0., 0., 1.],
               [0., 1., 0.],
               [0., 0., 1.],
               [0., 1., 0.],
               [1., 0., 0.],
               [0., 1., 0.],
               [0., 1., 0.],
               [0., 0., 1.],
               [0., 1., 0.],
               [0., 0., 1.],
               [1., 0., 0.],
               [0., 1., 0.],
               [0., 1., 0.],
               [0., 0., 1.],
               [0., 1., 0.],
               [0., 0., 1.],
               [1., 0., 0.],
               [0., 1., 0.],
               [0., 0., 1.],
               [1., 0., 0.],
               [0., 0., 1.]])
E6 = np.array([[0., 1.],
               [0., 1.],
               [0., 1.],
               [1., 0.],
               [1., 0.],
               [0., 1.],
               [1., 0.],
               [1., 0.],
               [0., 1.],
               [1., 0.],
               [1., 0.],
               [0., 1.],
               [0., 1.],
               [0., 1.],
               [1., 0.],
               [1., 0.],
               [1., 0.],
               [1., 0.],
               [1., 0.],
               [0., 1.],
               [0., 1.],
               [0., 1.],
               [0., 1.],
               [1., 0.],
               [1., 0.],
               [1., 0.],
               [1., 0.],
               [1., 0.],
               [0., 1.],
               [1., 0.],
               [0., 1.],
               [0., 1.],
               [1., 0.],
               [1., 0.],
               [0., 1.],
               [0., 1.],
               [0., 1.],
               [1., 0.],
               [0., 1.],
               [1., 0.],
               [0., 1.],
               [0., 1.],
               [1., 0.],
               [0., 1.],
               [1., 0.],
               [1., 0.],
               [0., 1.],
               [0., 1.],
               [1., 0.],
               [1., 0.],
               [1., 0.],
               [0., 1.],
               [0., 1.],
               [1., 0.],
               [0., 1.],
               [0., 1.],
               [0., 1.],
               [0., 1.],
               [1., 0.],
               [1., 0.],
               [0., 1.],
               [1., 0.],
               [1., 0.],
               [1., 0.],
               [1., 0.],
               [1., 0.],
               [0., 1.],
               [1., 0.],
               [0., 1.],
               [1., 0.],
               [0., 1.],
               [0., 1.],
               [1., 0.],
               [0., 1.],
               [1., 0.],
               [1., 0.],
               [1., 0.],
               [0., 1.],
               [0., 1.],
               [1., 0.],
               [1., 0.],
               [1., 0.],
               [1., 0.],
               [0., 1.],
               [0., 1.],
               [1., 0.],
               [1., 0.],
               [1., 0.],
               [0., 1.],
               [0., 1.],
               [1., 0.],
               [0., 1.],
               [1., 0.],
               [0., 1.],
               [1., 0.],
               [1., 0.],
               [1., 0.],
               [1., 0.],
               [1., 0.],
               [0., 1.]])
E7 = np.array([[0., 0., 0., 0., 0., 1.],
               [0., 0., 0., 0., 1., 0.],
               [0., 0., 0., 1., 0., 0.],
               [0., 1., 0., 0., 0., 0.],
               [0., 0., 1., 0., 0., 0.],
               [0., 0., 0., 1., 0., 0.],
               [0., 0., 0., 0., 1., 0.],
               [0., 0., 1., 0., 0., 0.],
               [0., 0., 0., 1., 0., 0.],
               [0., 1., 0., 0., 0., 0.],
               [0., 0., 0., 0., 1., 0.],
               [0., 0., 1., 0., 0., 0.],
               [0., 0., 0., 1., 0., 0.],
               [0., 0., 0., 0., 0., 1.],
               [0., 0., 0., 0., 1., 0.],
               [0., 0., 1., 0., 0., 0.],
               [0., 0., 1., 0., 0., 0.],
               [0., 0., 1., 0., 0., 0.],
               [0., 0., 1., 0., 0., 0.],
               [0., 0., 0., 1., 0., 0.],
               [0., 0., 0., 0., 1., 0.],
               [0., 0., 0., 1., 0., 0.],
               [0., 0., 1., 0., 0., 0.],
               [0., 0., 1., 0., 0., 0.],
               [0., 0., 0., 0., 1., 0.],
               [0., 0., 1., 0., 0., 0.],
               [0., 0., 1., 0., 0., 0.],
               [0., 0., 1., 0., 0., 0.],
               [0., 0., 0., 1., 0., 0.],
               [0., 0., 1., 0., 0., 0.],
               [0., 0., 0., 1., 0., 0.],
               [0., 1., 0., 0., 0., 0.],
               [0., 0., 1., 0., 0., 0.],
               [0., 0., 1., 0., 0., 0.],
               [0., 1., 0., 0., 0., 0.],
               [0., 0., 0., 1., 0., 0.],
               [0., 0., 0., 0., 0., 1.],
               [0., 0., 0., 1., 0., 0.],
               [0., 0., 0., 1., 0., 0.],
               [0., 0., 1., 0., 0., 0.],
               [0., 0., 1., 0., 0., 0.],
               [0., 0., 0., 0., 0., 1.],
               [0., 0., 0., 0., 0., 1.],
               [0., 0., 1., 0., 0., 0.],
               [0., 0., 1., 0., 0., 0.],
               [0., 0., 0., 1., 0., 0.],
               [0., 0., 0., 1., 0., 0.],
               [0., 0., 0., 1., 0., 0.],
               [0., 0., 0., 1., 0., 0.],
               [0., 0., 1., 0., 0., 0.],
               [0., 0., 1., 0., 0., 0.],
               [0., 0., 0., 0., 0., 1.],
               [0., 0., 0., 1., 0., 0.],
               [0., 0., 0., 0., 0., 1.],
               [0., 0., 0., 0., 0., 1.],
               [0., 0., 0., 1., 0., 0.],
               [0., 0., 0., 0., 0., 1.],
               [0., 0., 0., 1., 0., 0.],
               [0., 0., 1., 0., 0., 0.],
               [0., 0., 1., 0., 0., 0.],
               [0., 0., 0., 0., 0., 1.],
               [0., 0., 1., 0., 0., 0.],
               [0., 0., 1., 0., 0., 0.],
               [0., 0., 0., 1., 0., 0.],
               [0., 0., 0., 1., 0., 0.],
               [0., 0., 0., 1., 0., 0.],
               [0., 1., 0., 0., 0., 0.],
               [0., 0., 1., 0., 0., 0.],
               [0., 0., 0., 1., 0., 0.],
               [0., 0., 0., 1., 0., 0.],
               [0., 0., 1., 0., 0., 0.],
               [0., 0., 0., 1., 0., 0.],
               [0., 0., 1., 0., 0., 0.],
               [0., 0., 0., 1., 0., 0.],
               [0., 0., 1., 0., 0., 0.],
               [0., 0., 1., 0., 0., 0.],
               [0., 0., 0., 0., 1., 0.],
               [0., 0., 0., 0., 0., 1.],
               [0., 0., 0., 0., 0., 1.],
               [0., 0., 0., 1., 0., 0.],
               [0., 0., 0., 0., 1., 0.],
               [0., 1., 0., 0., 0., 0.],
               [0., 0., 0., 0., 1., 0.],
               [0., 0., 0., 1., 0., 0.],
               [0., 0., 0., 0., 0., 1.],
               [0., 0., 0., 1., 0., 0.],
               [0., 0., 1., 0., 0., 0.],
               [0., 0., 1., 0., 0., 0.],
               [0., 0., 1., 0., 0., 0.],
               [0., 0., 1., 0., 0., 0.],
               [0., 0., 0., 0., 0., 1.],
               [0., 0., 0., 1., 0., 0.],
               [0., 0., 0., 0., 1., 0.],
               [0., 0., 1., 0., 0., 0.],
               [0., 0., 1., 0., 0., 0.],
               [0., 0., 1., 0., 0., 0.],
               [0., 0., 0., 1., 0., 0.],
               [0., 1., 0., 0., 0., 0.],
               [0., 0., 0., 0., 0., 1.],
               [0., 0., 0., 0., 0., 1.]])
E8 = np.array([[1., 0.],
               [1., 0.],
               [0., 1.],
               [1., 0.],
               [0., 1.],
               [1., 0.],
               [0., 1.],
               [0., 1.],
               [1., 0.],
               [0., 1.],
               [1., 0.],
               [1., 0.],
               [1., 0.],
               [1., 0.],
               [1., 0.],
               [1., 0.],
               [1., 0.],
               [1., 0.],
               [1., 0.],
               [0., 1.],
               [1., 0.],
               [0., 1.],
               [1., 0.],
               [0., 1.],
               [1., 0.],
               [0., 1.],
               [1., 0.],
               [1., 0.],
               [1., 0.],
               [1., 0.],
               [1., 0.],
               [1., 0.],
               [0., 1.],
               [0., 1.],
               [1., 0.],
               [1., 0.],
               [1., 0.],
               [1., 0.],
               [0., 1.],
               [1., 0.],
               [1., 0.],
               [1., 0.],
               [1., 0.],
               [1., 0.],
               [1., 0.],
               [1., 0.],
               [1., 0.],
               [1., 0.],
               [0., 1.],
               [0., 1.],
               [1., 0.],
               [1., 0.],
               [1., 0.],
               [1., 0.],
               [0., 1.],
               [1., 0.],
               [1., 0.],
               [1., 0.],
               [0., 1.],
               [0., 1.],
               [0., 1.],
               [1., 0.],
               [1., 0.],
               [1., 0.],
               [1., 0.],
               [1., 0.],
               [1., 0.],
               [1., 0.],
               [1., 0.],
               [1., 0.],
               [1., 0.],
               [0., 1.],
               [1., 0.],
               [1., 0.],
               [1., 0.],
               [1., 0.],
               [0., 1.],
               [1., 0.],
               [1., 0.],
               [1., 0.],
               [1., 0.],
               [1., 0.],
               [0., 1.],
               [1., 0.],
               [0., 1.],
               [1., 0.],
               [1., 0.],
               [1., 0.],
               [1., 0.],
               [1., 0.],
               [1., 0.],
               [1., 0.],
               [0., 1.],
               [1., 0.],
               [1., 0.],
               [1., 0.],
               [1., 0.],
               [1., 0.],
               [1., 0.],
               [0., 1.]])

# einsum string for the opt_einsum compuation
einsum_notation = 'im,in,io,jk,jl,jm,jn,jq,kn,ko,lm,lo,lq,mn,mo,mq,mr,no,nq,nr,pq,Zj,Zk,Zl,Zm,Zn,Zo,Zp,Zq,Zr->Zi'

# precomputed path for the opt_einsum calculation and the sql code generation
path_info = [((19, 1), set(), 'nr,in->nri', None, False), ((15, 0), set(), 'mr,im->mri', None, False),
             ((7, 0), set(), 'ko,io->koi', None, False), ((14, 13), set(), 'pq,nq->pqn', None, False),
             ((24, 12), set(), 'koi,no->koin', None, False), ((24, 5), set(), 'koin,kn->koin', None, False),
             ((3, 0), set(), 'jn,jk->jnk', None, False), ((18, 6), set(), 'nri,mn->nrim', None, False),
             ((21, 17), set(), 'nrim,mri->nrim', None, False), ((7, 6), set(), 'mq,mo->mqo', (
        'jl', 'jm', 'jq', 'lm', 'lo', 'lq', 'Zj', 'Zk', 'Zl', 'Zm', 'Zn', 'Zo', 'Zp', 'Zq', 'Zr', 'pqn', 'koin', 'jnk',
        'nrim', 'mqo'), False), ((2, 1), set(), 'jq,jm->jqm', (
        'jl', 'lm', 'lo', 'lq', 'Zj', 'Zk', 'Zl', 'Zm', 'Zn', 'Zo', 'Zp', 'Zq', 'Zr', 'pqn', 'koin', 'jnk', 'nrim',
        'mqo',
        'jqm'), False), ((3, 2), set(), 'lq,lo->lqo', (
        'jl', 'lm', 'Zj', 'Zk', 'Zl', 'Zm', 'Zn', 'Zo', 'Zp', 'Zq', 'Zr', 'pqn', 'koin', 'jnk', 'nrim', 'mqo', 'jqm',
        'lqo'), False), ((16, 15), set(), 'jqm,mqo->jqmo', (
        'jl', 'lm', 'Zj', 'Zk', 'Zl', 'Zm', 'Zn', 'Zo', 'Zp', 'Zq', 'Zr', 'pqn', 'koin', 'jnk', 'nrim', 'lqo', 'jqmo'),
                         False), ((1, 0), set(), 'lm,jl->lmj', (
        'Zj', 'Zk', 'Zl', 'Zm', 'Zn', 'Zo', 'Zp', 'Zq', 'Zr', 'pqn', 'koin', 'jnk', 'nrim', 'lqo', 'jqmo', 'lmj'),
                                  False), (
                 (11, 10), set(), 'jnk,koin->jnkoi',
                 ('Zj', 'Zk', 'Zl', 'Zm', 'Zn', 'Zo', 'Zp', 'Zq', 'Zr', 'pqn', 'nrim', 'lqo', 'jqmo', 'lmj', 'jnkoi'),
                 False), ((9, 6), {'p'}, 'pqn,Zp->qnZ',
                          (
                              'Zj', 'Zk', 'Zl', 'Zm', 'Zn', 'Zo', 'Zq', 'Zr', 'nrim', 'lqo', 'jqmo', 'lmj', 'jnkoi',
                              'qnZ'),
                          'GEMM'), ((13, 4), set(), 'qnZ,Zn->qnZ', (
        'Zj', 'Zk', 'Zl', 'Zm', 'Zo', 'Zq', 'Zr', 'nrim', 'lqo', 'jqmo', 'lmj', 'jnkoi', 'qnZ'), False), (
                 (12, 5), set(), 'qnZ,Zq->qnZ',
                 ('Zj', 'Zk', 'Zl', 'Zm', 'Zo', 'Zr', 'nrim', 'lqo', 'jqmo', 'lmj', 'jnkoi', 'qnZ'), False), (
                 (6, 3), set(), 'nrim,Zm->nrimZ',
                 ('Zj', 'Zk', 'Zl', 'Zo', 'Zr', 'lqo', 'jqmo', 'lmj', 'jnkoi', 'qnZ', 'nrimZ'), False), (
                 (10, 4), {'r'}, 'nrimZ,Zr->nimZ',
                 ('Zj', 'Zk', 'Zl', 'Zo', 'lqo', 'jqmo', 'lmj', 'jnkoi', 'qnZ', 'nimZ'),
                 False), (
                 (6, 4), set(), 'lmj,lqo->lmjqo', ('Zj', 'Zk', 'Zl', 'Zo', 'jqmo', 'jnkoi', 'qnZ', 'nimZ', 'lmjqo'),
                 False),
             ((8, 4), set(), 'lmjqo,jqmo->lmjqo', ('Zj', 'Zk', 'Zl', 'Zo', 'jnkoi', 'qnZ', 'nimZ', 'lmjqo'), False),
             ((6, 5), set(), 'nimZ,qnZ->nimZq', ('Zj', 'Zk', 'Zl', 'Zo', 'jnkoi', 'lmjqo', 'nimZq'), False),
             ((4, 3), set(), 'jnkoi,Zo->jnkoiZ', ('Zj', 'Zk', 'Zl', 'lmjqo', 'nimZq', 'jnkoiZ'), False),
             ((5, 0), set(), 'jnkoiZ,Zj->jnkoiZ', ('Zk', 'Zl', 'lmjqo', 'nimZq', 'jnkoiZ'), False),
             ((4, 0), {'k'}, 'jnkoiZ,Zk->jnoiZ', ('Zl', 'lmjqo', 'nimZq', 'jnoiZ'), False),
             ((1, 0), {'l'}, 'lmjqo,Zl->mjqoZ', ('nimZq', 'jnoiZ', 'mjqoZ'), 'GEMM'),
             ((2, 0), {'q', 'm'}, 'mjqoZ,nimZq->joZni', ('jnoiZ', 'joZni'), False),
             ((1, 0), {'o', 'j', 'n'}, 'joZni,jnoiZ->Zi', ('Zi',), False)]
path = [i[0] for i in path_info]


def opt_einsum_discussion():
    tic = timer()
    sum_mask = np.array([1, 1])
    oe_result = oe.contract(einsum_notation, R0, R1, R2, R3, R4, R5, R6, R7, R8, R9, R10, R11, R12, R13, R14, R15, R16,
                            R17, R18, R19, R20, E0, E1, E2, E3, E4, E5, E6, E7, E8, optimize=path)
    oe_result = oe_result / np.outer(oe_result.dot(sum_mask), sum_mask)
    toc = timer()
    print(f"opt_einsum result: {oe_result}\n(computated in {toc - tic}s)")
    return toc - tic


if __name__ == "__main__":
    opt_einsum_discussion()
